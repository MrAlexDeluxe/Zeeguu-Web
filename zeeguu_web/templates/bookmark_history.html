{% macro bookmark_history(user) -%}


    {% set dates, urls_by_date, texts_by_url = user.bookmarks_by_url_by_date() %}

    {% for date in dates %}

        {% for url in urls_by_date[date] %}

            <div class="row col-md-offset-1 col-md-10">
                <h4><a href="{{ url.as_string() }}">{{ url.title_if_available() }} </a></h4>
                <b>{{ date.strftime("%A, %d %B %Y") }}</b>

                <table class="table table-striped table-no-borders">

                    <thead><tr><th></th></tr></thead>

                    {% for text in texts_by_url[url] %}
                        <tr><td>

                                {% for bookmark in text.all_bookmarks(user) %}

                                    <span id="star{{ bookmark.id }}">
                                        {% if bookmark.starred %}
                                            <a href="javascript:void(0);"
                                               onclick="unstarBookmark({{ bookmark.id }},{{ g.user.id }})">
                                                <i style="color:gold" class="icon-star"></i>
                                            </a>
                                        {% else %}
                                            <a href="javascript:void(0);"
                                               onclick="starBookmark({{ bookmark.id }},{{ g.user.id }})">
                                                <i style="color:lightgray" class="icon-star-empty"></i>
                                            </a>
                                        {% endif %}
                                    </span>

                                    <b>{{ bookmark.origin.word }} -- {{ bookmark.translation.word }}</b><br/>

                                {% endfor %}

                                &nbsp;&nbsp;&nbsp;&nbsp; {{ text.content }}

                        </td></tr>

                    {% endfor %}
                </table>
            </div>

        {% endfor %}

    {% endfor %}


{%- endmacro %}
